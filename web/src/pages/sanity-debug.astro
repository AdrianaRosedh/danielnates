---
import { sanity } from "../lib/sanity";
import { DANIEL_QUERY, PROJECTS_QUERY, FIELD_NOTES_QUERY } from "../lib/queries";

let daniel: any = null;
let projects: any[] = [];
let notes: any[] = [];
let err: any = null;

try {
  daniel = await sanity.fetch(DANIEL_QUERY);
  projects = await sanity.fetch(PROJECTS_QUERY);
  notes = await sanity.fetch(FIELD_NOTES_QUERY);
} catch (e: any) {
  err = { message: e?.message, statusCode: e?.statusCode, details: e?.details };
}
---

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sanity Debug</title>
    <style>
      body{background:#0b0b0c;color:#f3f3f3;font-family:system-ui;padding:16px}
      pre{background:rgba(255,255,255,.06);padding:12px;border-radius:12px;overflow:auto}
      h2{margin-top:18px}
      .muted{opacity:.7}
    </style>
  </head>
  <body>
    <h1>Sanity Debug</h1>
    <p class="muted">This is exactly what Astro receives from Sanity.</p>

    <h2>Error</h2>
    <pre>{JSON.stringify(err, null, 2)}</pre>

    <h2>Daniel</h2>
    <pre>{JSON.stringify(daniel, null, 2)}</pre>

    <h2>Projects</h2>
    <pre>{JSON.stringify(projects?.map((p:any)=>({title:p.title, slug:p.slug?.current, status:p.status})), null, 2)}</pre>

    <h2>Field Notes</h2>
    <pre>{JSON.stringify(notes?.map((n:any)=>({title:n.title, category:n.category})), null, 2)}</pre>
  </body>
</html>